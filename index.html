<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Resource Hub</title>

  <style>
    /* ===== Grief Sunrise Layout — Pink/Red Version ===== */
    :root{
      --bg: #0e0f1a;

      --text: #f6f2ff;
      --muted: rgba(246,242,255,.80);

      --panel: rgba(23, 20, 35, .72);
      --panel2: rgba(27, 23, 42, .78);
      --border: rgba(255,255,255,.14);

      /* Pink / grief tones */
      --accent: #ff6f91;
      --accent2:#ff4f6d;
      --accent3:#c75a7b;

      --tagbg: rgba(255,111,145,.14);
      --tagborder: rgba(255,111,145,.22);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);

      background:
        radial-gradient(900px 600px at 20% 0%, rgba(199,90,123,.35), transparent 60%),
        radial-gradient(900px 600px at 80% 15%, rgba(255,111,145,.25), transparent 55%),
        linear-gradient(180deg,
          #423A50 0%,
          #53455D 20%,
          #815F6B 42%,
          #B67967 62%,
          #c75a7b 78%,
          #ff6f91 88%,
          #ff4f6d 100%
        );

      min-height: 100vh;
    }

    header{
      padding: 28px 18px;
      border-bottom: 1px solid rgba(255,255,255,.12);

      background:
        radial-gradient(900px 500px at 15% 0%, rgba(199,90,123,.45), transparent 60%),
        radial-gradient(900px 500px at 85% 10%, rgba(255,111,145,.30), transparent 60%),
        linear-gradient(135deg, rgba(66,58,80,.88), rgba(14,15,26,.92));

      backdrop-filter: blur(6px);
    }

    .wrap{ max-width: 980px; margin: 0 auto; }
    h1{ margin:0 0 6px; font-size: 28px; }
    p{ margin:0; color: var(--muted); }

    main{ padding: 18px; }

    /* Featured image */
    .featuredWrap{ margin-top: 20px; display:flex; justify-content:center; }
    .featuredFigure{ margin:0; width: min(760px, 100%); }
    .featuredImg{
      width:100%;
      height:auto;
      display:block;
      border: 4px solid #000;
      border-radius: 14px;
      background:#000;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
    }
    .featuredCaption{
      margin-top:10px;
      font-size: 14px;
      text-align:center;
      color: var(--muted);
    }

    /* Cards */
    .grid{
      display:grid;
      gap:12px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      margin-top: 14px;
    }

    .card{
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 14px;
      box-shadow: 0 10px 28px rgba(0,0,0,.25);
      transition: .1s;
      backdrop-filter: blur(6px);
    }

    .card:hover{
      transform: translateY(-1px);
      box-shadow:
        0 18px 40px rgba(0,0,0,.35),
        0 0 0 1px rgba(255,111,145,.14),
        0 0 28px rgba(255,111,145,.12);
    }

    a{ color: var(--accent); text-decoration:none; }
    a:hover{ text-decoration: underline; }

    footer{
      padding: 24px 18px;
      color: rgba(246,242,255,.68);
      border-top: 1px solid rgba(255,255,255,.10);
    }

    /* ===== Support section styles ===== */
    .supportCard{
      padding: 18px;
      position: relative;
      overflow: hidden;
    }
    .supportCard:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(900px 480px at 15% 15%, rgba(255,111,145,.18), transparent 60%),
        radial-gradient(900px 480px at 85% 25%, rgba(199,90,123,.16), transparent 60%),
        linear-gradient(135deg, rgba(255,111,145,.08), rgba(0,0,0,0));
      pointer-events:none;
    }
    .supportInner{
      position: relative;
      display: grid;
      gap: 14px;
    }
    .supportTitle{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .supportTitle h2{
      margin:0;
      font-size: 20px;
      letter-spacing:.2px;
      color: var(--text);
    }
    .supportBadge{
      font-size:12px;
      padding:4px 10px;
      border-radius:999px;
      background: rgba(255,111,145,.12);
      border:1px solid rgba(255,111,145,.22);
      color: rgba(246,242,255,.92);
      white-space:nowrap;
    }
    .supportLead{
      margin:0;
      color: var(--muted);
      line-height: 1.55;
      max-width: 90ch;
    }

    /* Quick buttons */
    .quickRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:flex-start;
      margin-top: 2px;
    }
    .chipBtn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.12);
      color: rgba(246,242,255,.92);
      text-decoration:none;
      font-weight: 800;
      font-size: 13px;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, filter .08s ease, box-shadow .08s ease;
    }
    .chipBtn:hover{
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow: 0 0 0 1px rgba(255,111,145,.18), 0 0 22px rgba(255,111,145,.10);
    }
    .chipBtn:active{ transform: translateY(0px); }

    .supportNote{
      margin:0;
      color: rgba(246,242,255,.74);
      font-size: 13px;
      line-height: 1.5;
    }

    /* ===== Resource finder ===== */
    .finder{
      margin-top: 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .finderLeft{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      flex: 1 1 520px;
    }
    .finder input{
      flex: 1 1 320px;
      min-width: 240px;
      background: var(--panel2);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.14);
      padding: 10px 12px;
      border-radius: 999px;
      outline:none;
    }
    .finder input::placeholder{ color: rgba(246,242,255,.60); }

    .tagRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
    .tag{
      font-size:12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--tagbg);
      border: 1px solid var(--tagborder);
      color: rgba(246,242,255,.92);
      cursor:pointer;
      user-select:none;
      font-weight: 900;
    }
    .tag[aria-pressed="true"]{
      border-color: rgba(255,111,145,.45);
      box-shadow: 0 0 0 1px rgba(255,111,145,.18), 0 0 18px rgba(255,111,145,.16);
    }
    .finderRight{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }

    /* Tiny modal */
    .modalOverlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.62);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 9999;
    }
    .modal{
      max-width: 720px;
      width: 100%;
      background: rgba(23, 20, 35, .94);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 26px 90px rgba(0,0,0,.70);
      backdrop-filter: blur(10px);
    }
    .modalHead{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom: 10px;
    }
    .modal h3{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .modal p{
      margin:0;
      color: var(--muted);
      line-height:1.65;
      font-size: 14px;
    }
    .modal ul, .modal ol{
      margin: 10px 0 0;
      padding-left: 18px;
      color: var(--muted);
      line-height:1.65;
      font-size: 14px;
    }
    .modal li{ margin:6px 0; }

    details.softDetails{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(0,0,0,.10);
      margin-top: 10px;
    }
    details.softDetails summary{
      cursor: pointer;
      color: rgba(246,242,255,.92);
      font-weight: 900;
      list-style: none;
    }
    details.softDetails summary::-webkit-details-marker{ display:none; }
    details.softDetails p{
      margin:10px 0 0;
      color: var(--muted);
      line-height:1.6;
      font-size: 14px;
    }

    .modalActions{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      margin-top: 14px;
      flex-wrap:wrap;
    }
    .modalClose{
      padding: 9px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: rgba(246,242,255,.92);
      cursor:pointer;
      font-weight: 900;
    }

    @media (prefers-reduced-motion: reduce){
      .chipBtn, .card{ transition:none; }
    }

    /* ===== Living Grief Space ===== */
    .livingGrief{
      margin: 22px 0 10px;
      padding: 34px 18px;
      border-top: 1px solid rgba(255,255,255,.08);
      border-bottom: 1px solid rgba(255,255,255,.08);

      background:
        radial-gradient(800px 500px at 50% -10%, rgba(255,111,145,.18), transparent 60%),
        radial-gradient(900px 600px at 10% 120%, rgba(199,90,123,.14), transparent 60%),
        linear-gradient(180deg, rgba(10,9,16,.92), rgba(14,15,26,.96));

      backdrop-filter: blur(8px);
      border-radius: 18px;
    }

    .lgInner{
      max-width: 760px;
      margin: 0 auto;
      text-align: center;
      display: grid;
      gap: 18px;
    }

    .lgTitle{
      margin:0;
      font-size: 22px;
      letter-spacing:.2px;
      color: var(--text);
    }

    .lgLead{
      margin:0;
      color: var(--muted);
      line-height:1.65;
    }

    /* Breathing orb */
    .breathWrap{
      display:grid;
      gap:10px;
      justify-items:center;
      margin-top:6px;
    }

    .breathOrb{
      width: 104px;
      height: 104px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ffd0db, #ff4f6d);
      box-shadow:
        0 0 40px rgba(255,111,145,.45),
        inset 0 0 20px rgba(255,255,255,.25);
      animation: breathe 6s ease-in-out infinite;
    }

    @keyframes breathe{
      0%{ transform: scale(0.85); opacity:.78; }
      50%{ transform: scale(1.10); opacity:1; }
      100%{ transform: scale(0.85); opacity:.78; }
    }

    .breathText{
      margin:0;
      font-size: 13px;
      color: rgba(246,242,255,.65);
    }

    /* timer row */
    .breathTimerRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      margin-top: 4px;
    }
    .breathPill{
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      color: rgba(246,242,255,.92);
      cursor:pointer;
      font-weight: 900;
      transition: transform .08s ease, filter .08s ease, box-shadow .08s ease;
      user-select:none;
    }
    .breathPill:hover{
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow: 0 0 18px rgba(255,111,145,.22);
    }
    .breathPill[aria-pressed="true"]{
      border-color: rgba(255,111,145,.40);
      box-shadow: 0 0 0 1px rgba(255,111,145,.18), 0 0 26px rgba(255,111,145,.18);
    }
    .breathStatus{
      margin:0;
      font-size: 13px;
      color: rgba(246,242,255,.78);
      min-height: 18px;
    }
    .breathCountdown{
      margin:0;
      font-size: 12px;
      color: rgba(246,242,255,.62);
      min-height: 16px;
    }

    /* Daily message */
    .dailyBox{
      display:grid;
      gap:10px;
      justify-items:center;
      margin-top:6px;
    }

    .dailyBox p{
      margin:0;
      font-style: italic;
      color: rgba(246,242,255,.92);
      line-height: 1.6;
      max-width: 70ch;
    }

    /* Write & release */
    .releaseBox{
      display:grid;
      gap:10px;
      margin-top:4px;
    }

    .releaseBox textarea{
      width:100%;
      min-height:96px;
      resize:none;
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--text);
      font-family: inherit;
      outline: none;
    }
    .releaseBox textarea::placeholder{
      color: rgba(246,242,255,.55);
    }

    /* Buttons */
    .lgBtn{
      padding:8px 14px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.18);
      color: var(--text);
      font-weight: 900;
      cursor:pointer;
      transition:.15s;
    }
    .lgBtn:hover{
      transform: translateY(-1px);
      box-shadow: 0 0 18px rgba(255,111,145,.35);
    }
    .lgBtn:active{ transform: translateY(0px); }

    .lgFoot{
      margin:0;
      font-size: 12px;
      color: rgba(246,242,255,.55);
      line-height: 1.5;
    }

    /* ===== NEW: Floating helpers (flare) ===== */
    .fabStack{
      position: fixed;
      right: 14px;
      bottom: 14px;
      display: grid;
      gap: 10px;
      z-index: 9998;
    }
    .fab{
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.22);
      color: rgba(246,242,255,.92);
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 900;
      cursor: pointer;
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
      transition: transform .08s ease, filter .08s ease, box-shadow .08s ease, opacity .2s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
    }
    .fab:hover{
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow: 0 0 0 1px rgba(255,111,145,.18), 0 0 22px rgba(255,111,145,.10), 0 12px 30px rgba(0,0,0,.28);
    }
    .fab.show{
      opacity: 1;
      pointer-events: auto;
    }
    .fab small{
      font-weight: 800;
      color: rgba(246,242,255,.72);
    }

    /* Calm-screen overlay */
    .calmOverlay{
      position: fixed;
      inset: 0;
      display: none;
      z-index: 9999;
      background: #0b0d12;
      color: #e9e7f3;
    }
    .calmInner{
      max-width: 980px;
      margin: 0 auto;
      padding: 22px 18px 28px;
      display: grid;
      gap: 14px;
    }
    .calmTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .calmTitle{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
      color: rgba(233,231,243,.92);
    }
    .calmBtn{
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: rgba(233,231,243,.92);
      cursor: pointer;
      font-weight: 900;
    }
    .calmGrid{
      display:grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }
    .calmCard{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding: 14px;
    }
    .calmCard h3{
      margin:0 0 8px;
      font-size: 15px;
      color: rgba(233,231,243,.92);
    }
    .calmCard p{
      margin:0;
      color: rgba(233,231,243,.72);
      line-height: 1.6;
    }
    .calmHint{
      margin: 6px 0 0;
      color: rgba(233,231,243,.60);
      font-size: 12px;
      line-height: 1.5;
    }
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <h1>Resource Hub</h1>
    <p>A place to share helpful links, toolkits, PDFs, and guides.</p>

    <div class="featuredWrap">
      <figure class="featuredFigure">
        <img class="featuredImg" src="The_Weight_of_Grief.png" alt="The Weight of Grief visual">
        <figcaption class="featuredCaption">
          Grief doesn’t disappear, life grows around it.
        </figcaption>
      </figure>
    </div>
  </div>
</header>

<main class="wrap">

  <!-- ===== Living Grief Space ===== -->
  <section class="livingGrief">
    <div class="lgInner">
      <h2 class="lgTitle">A quiet space to land</h2>
      <p class="lgLead">
        If you arrived here carrying something heavy, pause for a moment.
        This space isn’t for fixing grief. It’s for sitting beside it.
      </p>

      <div class="breathWrap" aria-label="Breathing tool">
        <div class="breathOrb" aria-hidden="true"></div>
        <p class="breathText" id="breathPhaseText">Breathe in… breathe out…</p>

        <div class="breathTimerRow" aria-label="Breathing timer controls">
          <button class="breathPill" type="button" data-breath-min="0.5" aria-pressed="false">30s</button>
          <button class="breathPill" type="button" data-breath-min="1" aria-pressed="false">60s</button>
          <button class="breathPill" type="button" data-breath-min="2" aria-pressed="false">2 min</button>
          <button class="breathPill" type="button" data-breath-min="5" aria-pressed="false">5 min</button>
          <button class="breathPill" type="button" id="breathStart" aria-pressed="false">Start</button>
          <button class="breathPill" type="button" id="breathStop" aria-pressed="false">Stop</button>
        </div>

        <p class="breathStatus" id="breathStatusText"></p>
        <p class="breathCountdown" id="breathCountdownText"></p>
      </div>

      <div class="dailyBox" aria-label="Daily words">
        <p id="dailyMessage">Sometimes, in the weight we carry, we forget to see how far we've come..</p>
        <button class="lgBtn" type="button" id="btnNewWords">New words</button>
      </div>

      <div class="releaseBox" aria-label="Write and release">
        <textarea id="releaseText" placeholder="If something feels heavy… you can place the words here. No one will see them."></textarea>
        <button class="lgBtn" type="button" id="btnRelease">Release</button>
      </div>

      <p class="lgFoot">
        Nothing written here is stored. Some grief just needs somewhere gentle to exist for a moment.
      </p>
    </div>
  </section>

  <!-- ===== Parents ===== -->
  <section class="card supportCard" style="margin-top:16px; margin-bottom:14px;">
    <div class="supportInner">
      <div class="supportTitle">
        <h2>For parents carrying something heavy</h2>
        <span class="supportBadge">gentle + practical</span>
      </div>

      <p class="supportLead">
        If you’re here because life changed suddenly because of a death, diagnosis, separation, a move, financial stress, or a version of parenting you didn’t expect or anything else;
        you’re not doing it wrong. Grief isn’t only about death. It can be about <em>what was</em>, <em>what might have been</em>, and <em>what you’re holding together right now</em>.
        This hub offers steady language, simple tools, and reminders that you’re not alone.
      </p>

      <div class="quickRow" aria-label="Quick support buttons">
        <button class="chipBtn" type="button" data-modal="p_reset">Right now: 30-second reset</button>
        <button class="chipBtn" type="button" data-modal="p_waves">When grief comes in waves</button>
        <button class="chipBtn" type="button" data-modal="p_kids">What kids often need most</button>
        <button class="chipBtn" type="button" data-modal="p_more">More for caregivers</button>
      </div>

      <p class="supportNote">
        You can come back to this page when you have more capacity. No catching up required.
      </p>
    </div>
  </section>

  <!-- ===== Youth ===== -->
  <section class="card supportCard" style="margin-top:14px; margin-bottom:14px;">
    <div class="supportInner">
      <div class="supportTitle">
        <h2>For youth going through grief</h2>
        <span class="supportBadge">real talk + gentle tools</span>
      </div>

      <p class="supportLead">
        If you're a kid or teen reading this: grief can feel confusing, heavy, or like it shows up out of nowhere.
        You might feel sad, angry, numb, guilty, or totally "fine" and then not fine later. That’s normal.
        You don’t have to have the "right" emotions, you just deserve support.
      </p>

      <div class="quickRow" aria-label="Youth support buttons">
        <button class="chipBtn" type="button" data-modal="y_ground">When it hits suddenly</button>
        <button class="chipBtn" type="button" data-modal="y_feelings">Big feelings are allowed</button>
        <button class="chipBtn" type="button" data-modal="y_talk">If you don’t want to talk</button>
        <button class="chipBtn" type="button" data-modal="y_more">More for youth</button>
      </div>

      <p class="supportNote">
        You’re not "too much." Grief is a normal response to a hard thing. You don’t have to carry it alone.
      </p>
    </div>
  </section>

  <!-- ===== Resource finder ===== -->
  <section class="card" style="margin-top:14px;">
    <div style="font-weight:900; font-size:18px; margin-bottom:6px;">Find a page fast</div>
    <div style="color:var(--muted); line-height:1.55;">
      If you’re feeling overwhelmed, you don’t have to choose perfectly. Search, filter, or press “Start here.”
    </div>

    <div class="finder" aria-label="Resource finder">
      <div class="finderLeft">
        <input id="searchInput" type="text" placeholder="Search: grief, divorce, neurodiversity, school, change..." aria-label="Search resources" />
        <div class="tagRow" aria-label="Quick filters">
          <button class="tag" type="button" data-filter="kids" aria-pressed="false">kids</button>
          <button class="tag" type="button" data-filter="caregivers" aria-pressed="false">caregivers</button>
          <button class="tag" type="button" data-filter="change" aria-pressed="false">change</button>
          <button class="tag" type="button" data-filter="neuro" aria-pressed="false">neuro</button>
        </div>
      </div>

      <div class="finderRight">
        <button class="chipBtn" type="button" id="btnStartHere">Start here</button>
        <button class="chipBtn" type="button" id="btnClearFilters">Clear</button>
      </div>
    </div>
  </section>

  <!-- Cards injected here -->
  <section id="grid" class="grid" aria-label="Resource cards"></section>

  <!-- Discussion Board -->
  <section class="card" style="margin-top:18px;">
    <div style="font-weight:900; font-size:18px; margin-bottom:8px;">
      Discussion & Suggestions
    </div>
    <div style="color: var(--muted); margin-bottom:12px;">
      Share feedback, improvements, or resources to system administrator
    </div>

    <script src="https://utteranc.es/client.js"
            repo="phillip2999-ux/resource-hub"
            issue-term="pathname"
            label="discussion"
            theme="github-dark"
            crossorigin="anonymous"
            async>
    </script>
  </section>

</main>

<footer>
  <div class="wrap">
    Resource Hub • Community-informed & always growing
  </div>
</footer>

<!-- Modal -->
<div class="modalOverlay" id="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="modal">
    <div class="modalHead">
      <h3 id="modalTitle">Support</h3>
      <button class="modalClose" type="button" id="modalCloseTop">Close</button>
    </div>
    <div id="modalContent"></div>
    <div class="modalActions">
      <button class="modalClose" type="button" id="modalCloseBottom">Close</button>
    </div>
  </div>
</div>

<!-- Floating helpers -->
<div class="fabStack" aria-label="Quick helpers">
  <button class="fab" id="btnTop" type="button" aria-label="Back to top">↑ <span>Top</span></button>
  <button class="fab show" id="btnCalm" type="button" aria-label="Calm screen / quick exit">☁️ <span>Calm screen</span> <small>quick exit</small></button>
</div>

<!-- Calm screen overlay -->
<section class="calmOverlay" id="calmOverlay" aria-label="Calm screen">
  <div class="calmInner">
    <div class="calmTop">
      <h2 class="calmTitle">Weather + neutral notes</h2>
      <button class="calmBtn" id="btnReturn" type="button">Return</button>
    </div>

    <div class="calmGrid">
      <div class="calmCard">
        <h3>Today’s weather</h3>
        <p id="calmWeather">Partly cloudy. High 8°C / Low 2°C.</p>
        <p class="calmHint">Neutral screen for privacy and a quick breath.</p>
      </div>

      <div class="calmCard">
        <h3>One small plan</h3>
        <p>Water • snack • one text to a safe person • 10 minutes outside.</p>
        <p class="calmHint">No fixing required. Just the next tiny step.</p>
      </div>

      <div class="calmCard">
        <h3>Notes</h3>
        <p>Everything here is temporary. Close when you’re ready.</p>
        <p class="calmHint">Press Esc or “Return” to go back.</p>
      </div>
    </div>
  </div>
</section>

<script>
/* ===== Resource cards ===== */
const resources = [
  {
    title: "Relating to Grief",
    url: "coping-with-death/",
    note: "Stories and resources to help children understand death.",
    tags: ["kids","caregivers","grief"]
  },
  {
    title: "Ages and Stages",
    url: "ages-and-stages/",
    note: "Scripts + cues for what kids understand at different ages.",
    tags: ["kids","caregivers"]
  },
  {
    title: "Divorce and Separation",
    url: "divorce/",
    note: "Help kids feel safe, loved, and not responsible.",
    tags: ["kids","caregivers","change"]
  },
  {
    title: "Major Life Changes",
    url: "major-life-changes/",
    note: "Make change feel less scary with predictability and words that fit.",
    tags: ["kids","caregivers","change"]
  },
  {
    title: "Neurodiversity and Different Ways of Being",
    url: "neurodiversity/",
    note: "Support without 'fixing' — nervous system-friendly care.",
    tags: ["kids","caregivers","neuro"]
  }
];

const grid = document.getElementById("grid");

function renderCards(list){
  grid.innerHTML = list.map(r => `
    <article class="card">
      <div style="font-weight:800;">
        <a href="${r.url}">${r.title}</a>
      </div>
      ${r.note ? `<div style="margin-top:8px;color:var(--muted); line-height:1.55;">${r.note}</div>` : ""}
      ${r.tags && r.tags.length ? `
        <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
          ${r.tags.map(t => `<span style="font-size:12px;padding:4px 10px;border-radius:999px;background:rgba(0,0,0,.12);border:1px solid rgba(255,255,255,.12);color:rgba(246,242,255,.88);font-weight:900;">${t}</span>`).join("")}
        </div>
      ` : ""}
    </article>
  `).join("");
}
renderCards(resources);

/* ===== Living Grief Space logic ===== */
const MESSAGES = [
  "You're allowed to be both strong and struggling at the same time.",
  "Grief isn't a sign you're broken — it's a sign you loved.",
  "You don't have to carry today the way you carried yesterday.",
  "It's okay if healing looks like surviving right now.",
  "You're doing better than your mind tells you.",
  "Some days the bravest thing is just staying.",
  "Love doesn't end — it changes shape.",
  "You're allowed to rest from being strong.",
  "If you're tired, that makes sense. This is heavy.",
  "You don't need perfect words. Presence counts."
];

function newMessage(){
  const msg = MESSAGES[Math.floor(Math.random() * MESSAGES.length)];
  document.getElementById("dailyMessage").textContent = msg;
}

function releaseText(){
  const box = document.getElementById("releaseText");
  if(!box.value.trim()) return;
  box.style.transition = "opacity 1.5s ease";
  box.style.opacity = "0";
  setTimeout(()=>{
    box.value = "";
    box.style.opacity = "1";
  }, 1600);
}

document.getElementById("btnNewWords").addEventListener("click", newMessage);
document.getElementById("btnRelease").addEventListener("click", releaseText);

/* ===== Breathing Timer ===== */
const phaseEl = document.getElementById("breathPhaseText");
const statusEl = document.getElementById("breathStatusText");
const countdownEl = document.getElementById("breathCountdownText");
const startBtn = document.getElementById("breathStart");
const stopBtn = document.getElementById("breathStop");
const durationBtns = Array.from(document.querySelectorAll("[data-breath-min]"));

let selectedSeconds = 60;
let running = false;
let timerId = null;
let endAt = 0;
let phaseId = null;

const INHALE_MS = 4000;
const EXHALE_MS = 6000;

function setSelectedDuration(sec){
  selectedSeconds = sec;
  durationBtns.forEach(b => b.setAttribute("aria-pressed", String((Number(b.dataset.breathMin) * 60) === sec)));
  statusEl.textContent = `Selected: ${sec < 60 ? `${sec}s` : `${Math.round(sec/60)} min`}`;
}

function formatRemaining(ms){
  const totalSec = Math.max(0, Math.ceil(ms / 1000));
  const m = Math.floor(totalSec / 60);
  const s = totalSec % 60;
  if(m <= 0) return `${s}s`;
  return `${m}:${String(s).padStart(2,"0")}`;
}

function startBreathing(){
  if(running) return;
  running = true;
  startBtn.setAttribute("aria-pressed","true");
  stopBtn.setAttribute("aria-pressed","false");

  endAt = Date.now() + (selectedSeconds * 1000);
  statusEl.textContent = "Breathing…";
  countdownEl.textContent = `Time left: ${formatRemaining(endAt - Date.now())}`;

  function runPhase(){
    if(!running) return;
    phaseEl.textContent = "Breathe in…";
    phaseId = setTimeout(() => {
      if(!running) return;
      phaseEl.textContent = "Breathe out…";
      phaseId = setTimeout(() => runPhase(), EXHALE_MS);
    }, INHALE_MS);
  }
  runPhase();

  timerId = setInterval(() => {
    const remaining = endAt - Date.now();
    if(remaining <= 0){
      stopBreathing(true);
      return;
    }
    countdownEl.textContent = `Time left: ${formatRemaining(remaining)}`;
  }, 250);
}

function stopBreathing(finished=false){
  running = false;
  startBtn.setAttribute("aria-pressed","false");
  stopBtn.setAttribute("aria-pressed","true");

  if(timerId){ clearInterval(timerId); timerId = null; }
  if(phaseId){ clearTimeout(phaseId); phaseId = null; }

  countdownEl.textContent = "";
  phaseEl.textContent = "Breathe in… breathe out…";
  statusEl.textContent = finished ? "Done. You can restart anytime." : "Paused.";
}

durationBtns.forEach(btn => {
  btn.addEventListener("click", () => {
    const sec = Math.round(Number(btn.dataset.breathMin) * 60);
    setSelectedDuration(sec);
  });
});

startBtn.addEventListener("click", startBreathing);
stopBtn.addEventListener("click", () => stopBreathing(false));
setSelectedDuration(60);

/* ===== Resource finder logic ===== */
const searchInput = document.getElementById("searchInput");
const filterBtns = Array.from(document.querySelectorAll(".tag[data-filter]"));
const btnStartHere = document.getElementById("btnStartHere");
const btnClearFilters = document.getElementById("btnClearFilters");

let activeFilter = null;

function applyFilters(){
  const q = (searchInput.value || "").toLowerCase().trim();

  const filtered = resources.filter(r => {
    const hay = `${r.title} ${r.note || ""} ${(r.tags||[]).join(" ")}`.toLowerCase();
    const matchesText = !q || hay.includes(q);
    const matchesTag = !activeFilter || (r.tags || []).includes(activeFilter);
    return matchesText && matchesTag;
  });

  renderCards(filtered);
}

filterBtns.forEach(btn => {
  btn.addEventListener("click", () => {
    const key = btn.dataset.filter;
    activeFilter = (activeFilter === key) ? null : key;
    filterBtns.forEach(b => b.setAttribute("aria-pressed", String(b.dataset.filter === activeFilter)));
    applyFilters();
  });
});

searchInput.addEventListener("input", applyFilters);

btnClearFilters.addEventListener("click", () => {
  activeFilter = null;
  searchInput.value = "";
  filterBtns.forEach(b => b.setAttribute("aria-pressed","false"));
  renderCards(resources);
});

btnStartHere.addEventListener("click", () => {
  const pool = (activeFilter || (searchInput.value||"").trim())
    ? resources.filter(r => (activeFilter ? (r.tags||[]).includes(activeFilter) : true))
    : resources;

  const pick = pool[Math.floor(Math.random() * pool.length)] || resources[0];
  window.location.href = pick.url;
});

/* ===== Modals (FULL + CLOSED — this was the missing/broken part) ===== */
const MODALS = {
  p_reset: {
    title: "Right now: 30-second reset",
    html: `
      <p><strong>Try this once</strong> (no pressure) to "feel better."</p>
      <ol>
        <li>Put one hand on your chest or belly.</li>
        <li>Inhale for 4… exhale for 6 (twice).</li>
        <li>Name 3 things you can see.</li>
        <li>Tell yourself: "This is hard, and I'm here."</li>
      </ol>
    `
  },
  p_waves: {
    title: "When grief comes in waves",
    html: `
      <p>
        Hard days can return around milestones, seasons, school changes, birthdays, or even "ordinary" moments.
        That doesn't mean you're back at the start — it means love and memory still live close to the surface.
      </p>
      <details class="softDetails">
        <summary>Common moments that can hit unexpectedly</summary>
        <p>
          Bedtime. School drop-offs. Holidays and birthdays. Firsts (first day without them, first report card after the diagnosis, first visit to a new home).
          Seeing other families who seem "fine." Even a smell, song, or photo.
          Waves don’t mean failure — they’re a sign something mattered.
        </p>
      </details>
    `
  },
  p_kids: {
    title: "What kids often need most",
    html: `
      <p>
        They don’t need perfect answers — they need honesty, steadiness, and permission to feel.
        "I don’t know" is okay. "I’m here" is powerful.
      </p>
    `
  },
  p_more: {
    title: "More for caregivers",
    html: `
      <p>
        Parenting through grief often looks like “doing the basics” for a while — and it counts.
        Small acts are real care: water, food, a text to someone safe, a 10-minute walk, a quiet minute alone.
      </p>
      <p style="margin-top:10px;">
        <strong style="color: rgba(246,242,255,.92);">Something to remember:</strong>
        some grief is "living grief" — ongoing uncertainty, changing needs, or a life that looks different than expected.
        It still deserves care and language that doesn’t shame you for struggling.
      </p>
      <details class="softDetails">
        <summary>When it might help to reach out for extra support</summary>
        <p>
          If you're feeling unsafe, unable to cope, or like you might hurt yourself or someone else, please reach out for immediate support.
          If you're in Canada, you can call or text <strong>988</strong> for suicide crisis support, or call <strong>911</strong> in an emergency.
          For non-urgent support, consider talking with a trusted person, your family doctor, a counsellor, or a local community resource.
        </p>
      </details>
    `
  },

  y_ground: {
    title: "When it hits suddenly",
    html: `
      <p>
        Try a quick reset: name <strong>5 things you see</strong>, <strong>4 things you can touch</strong>,
        <strong>3 things you hear</strong>, <strong>2 things you smell</strong>, <strong>1 thing you taste</strong>.
        It helps your brain come back to the present.
      </p>
    `
  },
  y_feelings: {
    title: "Big feelings are allowed",
    html: `
      <p>
        Anger doesn’t mean you’re bad. Tears don’t mean you’re weak. Feeling nothing doesn’t mean you didn’t care.
        Your brain is doing its best to protect you.
      </p>
    `
  },
  y_talk: {
    title: "If you don’t want to talk",
    html: `
      <p>
        That’s okay. Some people process by moving: walking, gaming, music, sports, art, cleaning, being with pets.
        You can still be grieving even if you’re not talking about it.
      </p>
    `
  },
  y_more: {
    title: "More for youth",
    html: `
      <p>
        Pick one: drink water, eat something small, text a safe person "can you check in?", write one sentence in notes,
        or step outside for 2 minutes. Small steps matter.
      </p>
      <details class="softDetails">
        <summary>Words you can use when you don’t know what to say</summary>
        <p>
          "I'm having a hard time." • "I don’t want advice, I just want someone around." • "Can we talk about something else but stay together?"
          • "I’m not okay today." • "I don’t know what I feel."
        </p>
      </details>
      <details class="softDetails">
        <summary>If you feel unsafe or overwhelmed</summary>
        <p>
          If you're in danger or thinking about hurting yourself, tell an adult you trust right away.
          In Canada, you can call or text <strong>988</strong> any time, or call <strong>911</strong> in an emergency.
          You deserve help — even if you’re not sure how to explain it.
        </p>
      </details>
    `
  }
};

/* ===== Modal logic ===== */
const modalOverlay = document.getElementById("modalOverlay");
const modalTitle = document.getElementById("modalTitle");
const modalContent = document.getElementById("modalContent");
const closeTop = document.getElementById("modalCloseTop");
const closeBottom = document.getElementById("modalCloseBottom");

function openModal(key){
  const m = MODALS[key];
  if(!m) return;
  modalTitle.textContent = m.title;
  modalContent.innerHTML = m.html;
  modalOverlay.style.display = "flex";
}
function closeModal(){
  modalOverlay.style.display = "none";
}

document.querySelectorAll("[data-modal]").forEach(btn => {
  btn.addEventListener("click", () => openModal(btn.dataset.modal));
});

closeTop.addEventListener("click", closeModal);
closeBottom.addEventListener("click", closeModal);
modalOverlay.addEventListener("click", (e) => { if(e.target === modalOverlay) closeModal(); });
document.addEventListener("keydown", (e) => {
  if(e.key === "Escape"){
    // If calm screen is open, close it; otherwise close modals
    const calm = document.getElementById("calmOverlay");
    if(calm && calm.style.display === "block"){
      calm.style.display = "none";
    } else {
      closeModal();
    }
  }
});

/* ===== Floating helpers logic ===== */
const btnTop = document.getElementById("btnTop");
const btnCalm = document.getElementById("btnCalm");
const calmOverlay = document.getElementById("calmOverlay");
const btnReturn = document.getElementById("btnReturn");

function updateTopButton(){
  if(window.scrollY > 400){
    btnTop.classList.add("show");
  }else{
    btnTop.classList.remove("show");
  }
}
window.addEventListener("scroll", updateTopButton);
updateTopButton();

btnTop.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));

btnCalm.addEventListener("click", () => {
  calmOverlay.style.display = "block";
});

btnReturn.addEventListener("click", () => {
  calmOverlay.style.display = "none";
});

calmOverlay.addEventListener("click", (e) => {
  // allow click outside content to close
  if(e.target === calmOverlay) calmOverlay.style.display = "none";
});
</script>

</body>
</html>

